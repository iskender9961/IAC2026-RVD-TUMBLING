\documentclass[]{IAC_style}

\usepackage{amsmath,amssymb}

\begin{document}

\IACpaperyear{2026}
\IACpapernumber{IAC-26-C1.8.2-x00001}
\IACconference{77th International Astronautical Congress (IAC 2026)}
\IAClocation{Antalya, T\"{u}rkiye}
\IACdate{5-9 October 2026}

\IACcopyrightA{}

\title{Reachability-Aware Guidance for Approach to a Tumbling Uncooperative Target with Time-Varying LOS Constraints}

\IACauthor{Author 1$^{\orcidlink{0000-0000-0000-0000}}$}{1}{1}
\IACauthor{Author 2$^{\orcidlink{0000-0000-0000-0000}}$}{1}{0}
\IACauthoraffiliation{Affiliation 1, City, Country \normalfont{E-mail:~\authormail{author1@email.com}}}

\abstract{
This paper presents a reachability-aware guidance architecture for autonomous approach to a tumbling, uncooperative target under a rotating line-of-sight (LOS) docking corridor.
The LOS admissible set rotates with the target body frame, producing time-varying polyhedral constraints in the chaser's relative coordinates.
We develop a four-level certified feasibility hierarchy---robust, stochastic, nominal, and empirical Monte Carlo---that rigorously characterises the safe-start region under progressively relaxed assumptions.
The robust set guarantees constraint satisfaction for all bounded disturbances; the stochastic set provides 95\% probabilistic confidence under Gaussian process noise; the nominal set assumes perfect model knowledge; and the Monte Carlo set estimates empirical feasibility through exhaustive simulation.
By construction, $\mathcal{X}_{\mathrm{rob}} \subseteq \mathcal{X}_{\mathrm{stoch}} \subseteq \mathcal{X}_{\mathrm{nom}} \subseteq \mathcal{X}_{\mathrm{MC}}$.
Closed-loop guidance uses a receding-horizon MPC controller with CWH prediction dynamics, explicit LOS corridor constraints in the quadratic program, and a three-regime tracking law for far approach, body-frame co-rotation, and synchronised hold.
Truth propagation uses the exact discrete CWH state-transition matrix without reference blending or state projection.
Parametric sweeps over tumble rate (1--5~deg/s) and thrust authority (0.02--0.20~m/s$^2$) reveal the governing role of the dimensionless ratio $a_{\max}/\omega_t^2$ and confirm that approach from within the synchronisation radius maintains zero LOS violations.
}

\IACkeywords{proximity operations, uncooperative target, time-varying LOS corridor, reachability, safe-start region, feasibility hierarchy, MPC, CWH dynamics}

\maketitle
\thispagestyle{fancy}

\section*{Nomenclature}
$n$ \quad mean motion of target orbit (rad/s) \\
$\mathbf{x}=[x,y,z,\dot{x},\dot{y},\dot{z}]^\top$ \quad LVLH relative state (m, m/s) \\
$\mathbf{u}=[a_x,a_y,a_z]^\top$ \quad control acceleration (m/s$^2$) \\
$a_{\max}$ \quad maximum thrust-to-mass ratio (m/s$^2$) \\
$\omega_t$ \quad target tumble rate about body $z$-axis (rad/s) \\
$R_z(\theta)$ \quad rotation matrix about $z$ by angle $\theta$ \\
$\Phi(\tau)$, $B_d(\tau)$ \quad CWH state-transition and input matrices \\
$r_{\mathrm{sync}}$ \quad synchronisation range limit (m) \\
$\delta_i$ \quad directional per-constraint erosion (m) \\
$\mathcal{W}$ \quad bounded disturbance set \\
$\alpha$ \quad chance-constraint violation probability \\

\section*{Acronyms/Abbreviations}
CWH: Clohessy-Wiltshire-Hill; LOS: line of sight; LVLH: local vertical local horizontal; MPC: model predictive control; QP: quadratic program; MC: Monte Carlo

\section{Introduction}
Autonomous rendezvous and proximity operations with uncooperative targets are central to on-orbit servicing, active debris removal, and space situational awareness~\cite{Flores2014,Fehse2003}. When the target is tumbling, the docking corridor rotates with the target body frame, producing time-varying geometric constraints in the chaser's relative coordinate system~\cite{Virgili2019,Aghili2020}. The guidance problem is fundamentally harder than for cooperative, attitude-stabilised targets because the feasible region shrinks, rotates, and may vanish entirely if the tumble rate exceeds the chaser's control authority~\cite{Woffinden2007}.

Linearised relative motion using the Hill-Clohessy-Wiltshire (HCW) equations~\cite{Hill1878,Clohessy1960} provides a compact prediction model suitable for online guidance~\cite{Schaub2018}. Model predictive control (MPC) with explicit constraint embedding has been widely adopted for safe proximity operations~\cite{Weiss2015,Zagaris2018,Jewison2016,Richards2006}, typically for static keep-out zones or fixed LOS corridors. Extension to time-varying constraints from a tumbling target introduces additional challenges: the constraint landscape rotates, creating time-dependent feasibility that must be characterised before flight.

A critical pre-mission question is: \emph{from which initial states can the chaser safely approach and synchronise with the rotating hold point, given its thrust authority and the target's tumble rate?} Answering this question requires reachability analysis---computing the set of initial conditions from which the controller can maintain constraint satisfaction for all future time~\cite{Blanchini2008}. For robust operation, one must also account for process disturbances and modelling errors, leading to stochastic~\cite{Blackmore2011} and robust~\cite{Bemporad1999,Mammarella2020} formulations that tighten the safe region in exchange for formal guarantees.

This paper addresses the feasibility characterisation problem through a four-pronged approach:
\begin{itemize}
\item A \textbf{geometric safe-start region analysis} via directional per-constraint erosion and a synchronisation range bound, yielding conservative but computationally efficient inner approximations of the safe region.
\item A \textbf{four-level certified feasibility hierarchy}: robust (worst-case bounded disturbance), stochastic (Gaussian chance constraints at 95\% confidence), nominal (deterministic), and empirical Monte Carlo.
\item A \textbf{receding-horizon MPC controller} with CWH prediction dynamics and explicit LOS corridor constraints in the QP, solved via OSQP~\cite{Stellato2020}.
\item \textbf{Physically honest truth propagation} using the exact discrete CWH state-transition matrix without reference blending, state projection, or velocity overrides.
\end{itemize}

The remainder of the paper is organised as follows: Section~2 presents the dynamics model; Section~3 formulates the time-varying LOS corridor; Section~4 describes the guidance architecture; Section~5 develops the safe-start region analysis and feasibility hierarchy; Section~6 describes the Monte Carlo validation methodology; Section~7 presents results; Section~8 provides discussion; and Section~9 concludes.

\section{Dynamics Model}

\subsection{CWH Relative Motion}
Both the guidance prediction model and the truth propagation use the three-dimensional Clohessy-Wiltshire-Hill (CWH) linearised relative dynamics in the LVLH frame~\cite{Clohessy1960}. The continuous-time equations are:
\begin{align}
\ddot{x} &= 3n^2 x + 2n\dot{y} + a_x, \notag \\
\ddot{y} &= -2n\dot{x} + a_y, \label{eq:cwh} \\
\ddot{z} &= -n^2 z + a_z. \notag
\end{align}

The exact discrete-time state-transition matrix $\Phi(\tau)$ and zero-order-hold input matrix $B_d(\tau)$ are used for both MPC horizon predictions and truth propagation. Writing $c = \cos(n\tau)$, $s = \sin(n\tau)$:
\begin{equation}
\Phi(\tau) = \begin{bmatrix}
4 - 3c & 0 & 0 & s/n & 2(1-c)/n & 0 \\
6(s - n\tau) & 1 & 0 & -2(1-c)/n & (4s - 3n\tau)/n & 0 \\
0 & 0 & c & 0 & 0 & s/n \\
3ns & 0 & 0 & c & 2s & 0 \\
-6n(1-c) & 0 & 0 & -2s & 4c-3 & 0 \\
0 & 0 & -ns & 0 & 0 & c
\end{bmatrix}.
\label{eq:phi}
\end{equation}

The $(2,1)$ element $6(s - n\tau)$ produces secular along-track drift proportional to radial offset---a critical coupling absent in double-integrator models that dominates the long-range dynamics.

\subsection{Physically Honest Propagation}
A key design principle is that the truth simulation uses \emph{only} CWH dynamics plus the commanded acceleration---no reference blending, position projection, or velocity overrides are applied. This ensures that all feasibility claims are physically honest: if the chaser reports ``hold achieved'', it genuinely reached the hold band through dynamically consistent motion. Truth propagation uses sub-stepping (3 sub-steps per control interval) with the exact matrix exponential to maintain numerical accuracy.

During development, earlier implementations using double-integrator truth dynamics with reference blending produced artificially successful results. In those versions, ``phantom'' delta-v from state teleportation accounted for up to 80\% of the apparent fuel expenditure, and scenarios that should have been dynamically infeasible reported successful hold. The transition to CWH truth dynamics eliminated these artefacts.

\section{Time-Varying LOS Corridor}

\subsection{3D Body-Frame Formulation}
Let $\mathbf{p} = [x, y, z]^\top$ denote relative position in LVLH. The target body frame rotates about the LVLH $z$-axis at rate $\omega_t$:
\begin{equation}
\mathbf{p}_B = R_z(-\omega_t t)\,\mathbf{p}.
\end{equation}

In body-frame coordinates $[x_B, y_B, z_B]^\top$, the LOS corridor is a polyhedral cone defined by $n_c$ half-space inequalities:
\begin{equation}
A_c\,\mathbf{p}_B \le b_c,
\label{eq:los_3d}
\end{equation}
where $A_c \in \mathbb{R}^{n_c \times 3}$ encodes the polyhedral cone faces and a minimum-distance floor $y_B \ge y_{\min}$. In the MATLAB implementation, $n_c = 9$ (8 cone faces plus 1 floor constraint) with cone half-angle $30^\circ$.

\subsection{Body--LVLH Coordinate Transforms}
The body-to-LVLH velocity transform includes the transport term:
\begin{equation}
\mathbf{v}_L = R_z(\theta)\left(\mathbf{v}_B + \boldsymbol{\omega} \times \mathbf{r}_B\right),
\quad \boldsymbol{\omega} = [0, 0, \omega_t]^\top.
\end{equation}
This is critical for correct velocity matching: at range $r$, a body-frame--stationary chaser must maintain co-rotation velocity $v_{\mathrm{corot}} = \omega_t r$ in the LVLH frame.

\section{Guidance Architecture}

\subsection{Three-Regime Controller}
The controller operates in three regimes based on range $r = \|\mathbf{r}\|$ relative to the synchronisation radius $r_{\mathrm{sync}} = 2a_{\max}/\omega_t^2$:

\begin{enumerate}
\item \textbf{Far approach} ($r > r_{\mathrm{sync}}$): LVLH-frame PD tracking of a spiral reference with velocity limiting, capped at $v_{\mathrm{achv}} = \min(a_{\max} t / 2, v_{\max})$.

\item \textbf{Close approach} ($r \le r_{\mathrm{sync}}$): body-frame PD tracking with the reference transformed to body-frame coordinates. This regime naturally handles co-rotation.

\item \textbf{Hold} ($r_h - \epsilon \le r \le r_h + \epsilon$, $v < v_{\mathrm{switch}}$): synchronised station-keeping with CWH gravity-gradient feedforward:
\begin{equation}
\mathbf{a}_{\mathrm{ff}} = -\begin{bmatrix} 3n^2 x + 2n\dot{y} \\ -2n\dot{x} \\ -n^2 z \end{bmatrix}.
\end{equation}
\end{enumerate}

\subsection{MPC Safety Filter with Explicit LOS Constraints}
The nominal PD command is refined through a QP-based safety filter~\cite{Mayne2000}. Over a horizon of $N_p = 40$ steps at $\Delta t = 1$~s, the QP minimises a cost combining reference tracking, control effort, and control smoothness:
\begin{equation}
J = \sum_{j=1}^{N_p} \left( \|\hat{\mathbf{x}}_j - \mathbf{x}^{\mathrm{ref}}_j\|^2_{Q} + \|\Delta \mathbf{u}_j\|^2_{R_{\Delta u}} \right) + \|\mathbf{u}\|^2_{R_u},
\label{eq:qp_cost}
\end{equation}
subject to CWH dynamics~\eqref{eq:cwh}, LOS corridor constraints~\eqref{eq:los_3d} at each horizon step, and thrust bounds $\|\mathbf{u}\|_\infty \le a_{\max}$. The QP is solved using OSQP~\cite{Stellato2020} with warm-starting.

\section{Safe-Start Region Analysis}

\subsection{Directional Per-Constraint Erosion}
The rotation of the body frame at rate $\omega_t$ creates an apparent velocity for an inertially-stationary chaser. For each constraint face $i$ in~\eqref{eq:los_3d}, the margin consumed during the settling transient before the thruster arrests the rotation-induced drift is:
\begin{equation}
\delta_i = \frac{(\dot{s}_i^-)^2}{2\,a_{\max}},
\label{eq:erosion}
\end{equation}
where $\dot{s}_i^- = \min(0, \dot{s}_i)$ is the negative part of the constraint-slack rate and $\dot{s}_i = -\mathbf{a}_i^\top \mathbf{v}_{\mathrm{rot}}$ with $\mathbf{v}_{\mathrm{rot}} = [\omega_t y_B, -\omega_t x_B, 0]^\top$. The point is declared safe if $s_i - \delta_i > 0$ for all $i$.

\subsection{Synchronisation Range Bound}
At range $r$, the apparent rotational speed is $v_{\mathrm{rot}} = \omega_t r$. Requiring the braking distance $d_{\mathrm{brake}} = \omega_t^2 r^2 / (2a_{\max})$ to be less than $r$ gives:
\begin{equation}
r < r_{\mathrm{sync}} = \frac{2\,a_{\max}}{\omega_t^2}.
\label{eq:rsync}
\end{equation}

For the parameter range considered, $r_{\mathrm{sync}}$ varies from 1145~m ($\omega_t = 1$~deg/s, $a_{\max} = 0.20$) down to 0.92~m ($\omega_t = 5$~deg/s, $a_{\max} = 0.02$).

\input{data/feasibility_hierarchy.tex}

\input{data/example_double_integrator.tex}

\section{Monte Carlo Validation Methodology}
\label{sec:mc}

To establish the empirical safe region $\mathcal{X}_{\mathrm{MC}}$, we perform exhaustive Monte Carlo simulations for each $(\omega_t, a_{\max})$ combination. For each of the $5 \times 4 = 20$ parameter combinations:

\begin{enumerate}
\item \textbf{Initial conditions}: A grid of $15 \times 13 = 195$ initial positions is generated in the body-frame $(x_B, y_B)$ plane, with $y_B \in [20, 300]$~m and $x_B \in [-0.95\, c_k \, y_B, \; 0.95\, c_k \, y_B]$ where $c_k = \tan(30^\circ)$. Initial velocity is set to zero in body frame.

\item \textbf{Full closed-loop simulation}: Each initial condition is simulated for $T_{\mathrm{sim}} = 400$~s using the full CWH truth dynamics and the three-regime MPC controller with $N_p = 20$, $\Delta t = 1$~s.

\item \textbf{Outcome classification}: A simulation is classified as \emph{feasible} if no LOS constraint violation exceeds the tolerance $\epsilon = 10^{-3}$ at any time step.

\item \textbf{Safe region interpolation}: The scattered feasibility outcomes are interpolated onto the analytical evaluation grid using natural-neighbour interpolation with nearest-neighbour extrapolation.
\end{enumerate}

Monte Carlo simulations use MATLAB parallel computing (parfor) with progress tracking via DataQueue.

\section{Results}

\subsection{Nominal Reachability Maps}
Table~\ref{tab:reachability_sweep} reports the safe fraction of the LOS cone for each combination, using the forward erosion criterion~\eqref{eq:erosion} with the synchronisation range bound~\eqref{eq:rsync}.

\input{data/reachability_table.tex}

The safe fraction decreases rapidly with tumble rate due to the $\omega_t^{-2}$ dependence of $r_{\mathrm{sync}}$ and the quadratic growth of the erosion term. At $\omega_t = 1$~deg/s with $a_{\max} = 0.20$~m/s$^2$, 80.1\% of the cone is certified safe; at $\omega_t = 5$~deg/s with $a_{\max} = 0.02$~m/s$^2$, the safe region shrinks to near zero.

\subsection{Feasibility Hierarchy Results}
Fig.~\ref{fig:hierarchy} shows the nested feasibility regions for all 20 parameter combinations.

\begin{figure}[H]
\centering
\includegraphics[width=\columnwidth]{figures/comparison_grid.png}
\caption{Nested feasibility hierarchy for all 20 parameter combinations. Each panel shows $\mathcal{X}_{\mathrm{rob}}$ (purple) $\subseteq$ $\mathcal{X}_{\mathrm{stoch}}$ (blue) $\subseteq$ $\mathcal{X}_{\mathrm{nom}}$ (green), shrinking as tumble rate increases or thrust authority decreases.}
\label{fig:hierarchy}
\end{figure}

The stochastic set (95\% Gaussian confidence with Bonferroni correction) is slightly smaller than the nominal set due to accumulated process noise tightening $\Delta_i^{\mathrm{stoch}} = z_{0.975/n_c} \cdot \sigma_i$, where $\sigma_i^2 = \mathbf{a}_i^\top \Sigma_N \mathbf{a}_i$ and $\Sigma_N = \sum_{j=0}^{N-1} \Phi^j W (\Phi^j)^\top$.

The robust set is the most conservative, tightening each constraint by the worst-case accumulated disturbance support function $\Delta_i^{\mathrm{rob}} = \sum_{j=0}^{N-1} \sum_k |\mathbf{a}_i^\top \Phi^j \mathbf{e}_k| \cdot w_{\max,k}$.

\subsection{Inclusion Hierarchy Verification}
The inclusion $\mathcal{X}_{\mathrm{rob}} \subseteq \mathcal{X}_{\mathrm{stoch}} \subseteq \mathcal{X}_{\mathrm{nom}}$ is verified numerically by checking every grid point: no violations are found across all 20 parameter combinations.

\subsection{Nominal Forward and Backward Analysis}
Fig.~\ref{fig:nominal_grid} shows the nominal forward reachable sets for all parameter combinations. The forward analysis uses the erosion model~\eqref{eq:erosion}; the backward analysis computes the viability kernel via discrete multi-step LP-based verification.

\begin{figure}[H]
\centering
\includegraphics[width=\columnwidth]{figures/nominal_forward_grid.png}
\caption{Nominal forward safe-start regions for 5 tumble rates $\times$ 4 thrust authorities. Green: certified safe; blue: inside cone but unsafe; red: outside LOS cone.}
\label{fig:nominal_grid}
\end{figure}

The backward analysis reveals that the discrete LP-based safe region is substantially larger than the erosion-based conservative estimate, particularly at low tumble rates where the controller has significant margin. This gap quantifies the conservatism of the erosion model.

\subsection{Monte Carlo Validation}
Fig.~\ref{fig:mc_grid} shows the MC empirical feasibility maps from the parametric sweep.

\begin{figure}[H]
\centering
\includegraphics[width=\columnwidth]{figures/fig_mc_sweep_grid.png}
\caption{Monte Carlo feasibility sweep: 195 initial conditions per scenario, classified by three-colour heatmap (green: feasible, red: infeasible, yellow: partial).}
\label{fig:mc_grid}
\end{figure}

\subsection{Single-Scenario Overlay}
Fig.~\ref{fig:single} shows the nested overlay for a representative case ($\omega_t = 2$~deg/s, $a_{\max} = 0.10$~m/s$^2$), demonstrating the progressive shrinkage from MC to robust.

\begin{figure}[H]
\centering
\includegraphics[width=0.95\columnwidth]{figures/single_w2_a0.10.png}
\caption{Single-scenario overlay for $\omega_t = 2$~deg/s, $a_{\max} = 0.10$~m/s$^2$, showing the nested structure MC $\supseteq$ nominal $\supseteq$ stochastic $\supseteq$ robust.}
\label{fig:single}
\end{figure}

\subsection{Closed-Loop Sweep}
\input{data/sweep_table.tex}

Table~\ref{tab:sweep} reports closed-loop approach outcomes for 15 combinations starting from 195~m. The sweep confirms that long-range starts exceed $r_{\mathrm{sync}}$ for most cases, motivating initial-range studies.

\subsection{Initial-Range Study}
Starting from within $r_{\mathrm{sync}}$, the 50~m case ($\omega_t \approx 1.72$~deg/s, $a_{\max} = 0.10$~m/s$^2$, $r_{\mathrm{sync}} = 222$~m) achieves \textbf{zero LOS violations}, validating the reachability predictions. In contrast, 150~m and 100~m starts produce violations from CWH along-track drift.

\section{Discussion}

\subsection{The Price of Certification}
The gap between $\mathcal{X}_{\mathrm{MC}}$ and $\mathcal{X}_{\mathrm{rob}}$ quantifies the operational cost of formal safety guarantees. For benign cases ($\omega_t = 1$~deg/s, $a_{\max} = 0.20$~m/s$^2$), the robust region still covers a substantial fraction of the cone, making certified operation practical. For aggressive cases ($\omega_t \ge 4$~deg/s), all analytical regions shrink dramatically, suggesting that alternative strategies (e.g., de-tumbling the target first) may be necessary.

\subsection{CWH Along-Track Coupling}
The secular term $6n(s - n\tau)$ in the CWH state-transition matrix produces along-track drift proportional to radial offset. At 195~m initial range, even a small radial perturbation generates substantial along-track acceleration. This coupling, absent in double-integrator models, dominates the long-range dynamics and explains the difficulty of approach from outside $r_{\mathrm{sync}}$.

\subsection{Computational Efficiency}
The analytical reachability computation (nominal + stochastic + robust for all 20 combinations on a $300 \times 300$ grid) completes in under 100~s on a standard workstation, compared to hours for the Monte Carlo sweep (195 simulations $\times$ 400 time steps per scenario $\times$ 20 combinations). This two-to-three orders-of-magnitude speedup enables real-time mission planning applications.

\subsection{Role of $a_{\max}/\omega_t^2$}
The dimensionless ratio $a_{\max}/\omega_t^2$ (with units of metres) governs feasibility: it equals $r_{\mathrm{sync}}/2$ and determines both the spatial extent of the safe region and the erosion magnitude. All results collapse when plotted against this single parameter, suggesting a universal scaling law for rotating-corridor approach problems.

\section{Limitations and Planned Extensions}
The erosion model~\eqref{eq:erosion} is conservative: it considers only instantaneous braking without accounting for optimal multi-constraint trajectories. The range bound~\eqref{eq:rsync} assumes worst-case velocity cancellation. Planned extensions include:
\begin{enumerate}
\item Formal Hamilton-Jacobi viability-kernel computation for comparison with the erosion-based approximation.
\item Multi-phase approach strategies: LVLH approach to $r_{\mathrm{sync}}$, then body-frame co-rotation.
\item Extension to general 3D tumble with full attitude kinematics (quaternion propagation).
\item Integration of navigation uncertainty (relative pose estimation errors).
\end{enumerate}

\section{Conclusions}
A reachability-aware guidance architecture has been developed for approach to a tumbling target under a rotating LOS docking corridor. The main contributions are:
\begin{enumerate}
\item A \textbf{four-level certified feasibility hierarchy} ($\mathcal{X}_{\mathrm{rob}} \subseteq \mathcal{X}_{\mathrm{stoch}} \subseteq \mathcal{X}_{\mathrm{nom}} \subseteq \mathcal{X}_{\mathrm{MC}}$) providing progressively stronger safety guarantees through constraint tightening.
\item \textbf{Directional per-constraint erosion} and a \textbf{synchronisation range bound} $r_{\mathrm{sync}} = 2a_{\max}/\omega_t^2$ yielding computationally efficient safe-start region characterisation.
\item A \textbf{three-regime MPC guidance law} with physically honest CWH truth propagation, validated by Monte Carlo simulation across 20 parameter combinations.
\item The identification of $a_{\max}/\omega_t^2$ as the \textbf{universal scaling parameter} governing approach feasibility in rotating-corridor problems.
\end{enumerate}

All results are reproducible from the open-source code repository.

\section*{Acknowledgements}
The authors acknowledge the open-source tools and prior astrodynamics foundations used to build this reproducible demonstration framework.

\bibliography{references}

\end{document}
